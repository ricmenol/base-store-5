import{a as y}from"./chunk-R2O6QX4D-CX21ziz_.js";import{S}from"./chunk-PYIO3TDQ-D8Zv8hXV.js";import{u as v}from"./chunk-6CNRNROJ-Cvp6AfPW.js";import{C}from"./chunk-W6N53UNG-BUeeAVFO.js";import{u as L,c as O}from"./chunk-BF3VCHXD-CZWEYFV9.js";import{a1 as E,a3 as g,ex as T,a4 as F,b as _,R as k,ar as I,j as e,H as w,s as N,a8 as R,a9 as V,t as j,w as o,x as B,D as P,B as b}from"./index-DkzW1lbC.js";import{S as D}from"./chunk-CBJWO6K6-SUuqZ14f.js";import{K as M}from"./chunk-6HTZNHPT-BAw8hsS0.js";import{b as d,u as q}from"./chunk-AYRG2MQL-p8d_KfEl.js";import{R as x}from"./radio-group-BnqlWkYQ.js";import"./x-mark-mini-bZP8SCsT.js";import"./triangles-mini-7BXnDNsU.js";import"./plus-mini-CrzVgHGc.js";import"./prompt-PHMJs5xL.js";import"./index-hwIAkjuo.js";function H(l,n){const s={};return n.forEach(t=>{t in l&&(s[t]=l[t])}),s}var K=E({name:g().min(1),price_type:T(S),enabled_in_store:F().optional(),shipping_profile_id:g()}),$=({locationId:l,shippingOption:n})=>{const{t:s}=_(),{handleSuccess:t}=q(),p=v({queryFn:i=>N.admin.shippingProfile.list(i),queryKey:["shipping_profiles"],getOptions:i=>i.shipping_profiles.map(c=>({label:c.name,value:c.id})),defaultValue:n.shipping_profile_id}),a=R({defaultValues:{name:n.name,price_type:n.price_type,enabled_in_store:y(n),shipping_profile_id:n.shipping_profile_id},resolver:V(K)}),{mutateAsync:h,isPending:u}=O(n.id),m=a.handleSubmit(async i=>{const c=n.rules.map(r=>({...H(r,["id","attribute","operator","value"])})),f=c.find(r=>r.attribute==="enabled_in_store");f?f.value=i.enabled_in_store?"true":"false":c.push({value:i.enabled_in_store?"true":"false",attribute:"enabled_in_store",operator:"eq"}),await h({name:i.name,price_type:i.price_type,shipping_profile_id:i.shipping_profile_id,rules:c},{onSuccess:({shipping_option:r})=>{j.success(s("stockLocations.shippingOptions.edit.successToast",{name:r.name})),t(`/settings/locations/${l}`)},onError:r=>{j.error(r.message)}})});return e.jsx(d.Form,{form:a,children:e.jsxs(M,{onSubmit:m,className:"flex flex-1 flex-col",children:[e.jsx(d.Body,{children:e.jsx("div",{className:"flex flex-col gap-y-8",children:e.jsxs("div",{className:"flex flex-col gap-y-8",children:[e.jsx(o.Field,{control:a.control,name:"price_type",render:({field:i})=>e.jsxs(o.Item,{children:[e.jsx(o.Label,{children:s("stockLocations.shippingOptions.fields.priceType.label")}),e.jsx(o.Control,{children:e.jsxs(x,{...i,onValueChange:i.onChange,children:[e.jsx(x.ChoiceBox,{className:"flex-1",value:"flat",label:s("stockLocations.shippingOptions.fields.priceType.options.fixed.label"),description:s("stockLocations.shippingOptions.fields.priceType.options.fixed.hint")}),e.jsx(x.ChoiceBox,{className:"flex-1",value:"calculated",label:s("stockLocations.shippingOptions.fields.priceType.options.calculated.label"),description:s("stockLocations.shippingOptions.fields.priceType.options.calculated.hint")})]})}),e.jsx(o.ErrorMessage,{})]})}),e.jsxs("div",{className:"grid gap-y-4",children:[e.jsx(o.Field,{control:a.control,name:"name",render:({field:i})=>e.jsxs(o.Item,{children:[e.jsx(o.Label,{children:s("fields.name")}),e.jsx(o.Control,{children:e.jsx(B,{...i})}),e.jsx(o.ErrorMessage,{})]})}),e.jsx(o.Field,{control:a.control,name:"shipping_profile_id",render:({field:i})=>e.jsxs(o.Item,{children:[e.jsx(o.Label,{children:s("stockLocations.shippingOptions.fields.profile")}),e.jsx(o.Control,{children:e.jsx(C,{...i,options:p.options,searchValue:p.searchValue,onSearchValueChange:p.onSearchValueChange,disabled:p.disabled})}),e.jsx(o.ErrorMessage,{})]})})]}),e.jsx(P,{}),e.jsx(D,{control:a.control,name:"enabled_in_store",label:s("stockLocations.shippingOptions.fields.enableInStore.label"),description:s("stockLocations.shippingOptions.fields.enableInStore.hint")})]})})}),e.jsx(d.Footer,{children:e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(d.Close,{asChild:!0,children:e.jsx(b,{size:"small",variant:"secondary",children:s("actions.cancel")})}),e.jsx(b,{size:"small",type:"submit",isLoading:u,children:s("actions.save")})]})})]})})},te=()=>{const{t:l}=_(),{location_id:n,so_id:s}=k(),{shipping_options:t,isPending:p,isFetching:a,isError:h,error:u}=L({id:s}),m=t==null?void 0:t.find(i=>i.id===s);if(!p&&!a&&!m)throw I({message:`Shipping option with ID ${s} was not found`},404);if(h)throw u;return e.jsxs(d,{children:[e.jsx(d.Header,{children:e.jsx(w,{children:l("stockLocations.shippingOptions.edit.header")})}),m&&e.jsx($,{shippingOption:m,locationId:n})]})};export{te as Component};
